# 多元函数微分学



## 偏导数



### 定义

设函数 $z = f(x,y) $ 在点  $(x_0, y_0)$ 的某领域内有定义，且存在极限

```math
lim_{\Delta x \rightarrow0} \frac{f(x_0+\Delta x,y_0) - f(x_0, y_0)}{\Delta x}
```

则称此极限为函数 $z=f(x,y)$ 在点 $(x_0, y_0)$ 处对 $x$ 的偏导数，记为：

```math
\frac{\partial z}{\partial x}|_{x=x_0,y=y_0}  \ 或\  z_x'(x_0,y_0)
```

对 $y$ 的偏导同理。



**计算** ： 在计算多元函数对某一变量的偏导时，将多元函数看成这一个变量的函数，将其他变量视为常量，按照一元函数求导计算；对于直接求导难以得到答案的情况，也可以直接以极限的方式求偏导。



### 高阶偏导

对于高阶偏导，存在一定理：

设函数 $z=f(x,y)$ 在区域 $D$ 上连续，且其两个二阶混合偏导在 $D$ 内存在且连续，那么这两偏导必然相等，即：

```math
f_{xy}''(x,y) = f_{yx}''(x, y)
```

### 全微分

设函数 $z=f(x,y)$ 在点 $(x,y)$ 的某领邻域内有定义，那么其在点 $(x,y)$ 处的增量可表示为

```math
\Delta z = f(x+\Delta x, y+\Delta y) - f(x,y) \\ \Rightarrow \Delta z=A\Delta x + B\Delta y + o(\rho)
```

其中，$\rho=\sqrt{\Delta x^2 + \Delta y^2}$ ，$A,B$ 是定值。记 $dx = \Delta x,dy = \Delta y$ 那么有：

```math
dz = Adx + Bdy
```

其中 $A=\frac{\partial z}{\partial x}, B=\frac{\partial z}{\partial y}$ 。





## 多元复合函数的求导法则



### 链式法则

- 如果函数 $u=\phi(t), v=\psi(t)$ 在点 $t$ 处存在导数， 函数 $z=f(u,v)$ 在对应点 $(u,v)$ 处存在连续偏导，则复合函数 $z=f[\phi(t),\psi(t)]$ 在点 $t$ 处可导，则有：

```math
\frac{dz}{dt} \ =\  \frac{\partial z}{\partial u}\frac{du}{dt}+\frac{\partial z}{\partial v}\frac{dv}{dt}
```

- 如果函数 $u=φ(x,y), \ v=\psi(x,y)$ 都在点 $(x,y)$ 处有对 $x, y$ 的导数，函数 $z=f(u,v)$ 在对应点 $(u,v)$ 有连续偏导数，则函数 $z=f(φ,\psi)$ 在点 $(x,y)$ 处的两个导数都存在，则：

  ```math
  \frac{dz}{dx} \ =\  \frac{\partial z}{\partial u}\frac{du}{dx}+\frac{\partial z}{\partial v}\frac{dv}{dx} \\
  \frac{dz}{dy} \ =\  \frac{\partial z}{\partial u}\frac{du}{dy}+\frac{\partial z}{\partial v}\frac{dv}{dy}
  ```

  

### 形式不变性

设函数 $z=f(u,v)$ 以及函数 $u=φ(x,y), \ v=\psi(x,y)$ 均可微，则复合函数可微分为：

```math
dz = \frac{\partial z}{\partial x}dx + \frac{\partial z}{\partial y}dy \\
dz = \frac{\partial z}{\partial u}du + \frac{\partial z}{\partial v}dv
```



## 隐函数的求导法则



设函数 $F(x,y)$ 满足条件

-  $F(x,y)$ 在点 $(x_0,y_0)$ 的某一邻域内有连续偏导
- $F(x,y)=0$
- $F_y(x_0,y_0) \neq 0$

则方程 $F(x,y)=0$ 在点 $(x_0,y_0)$ 的某一邻域内能唯一确定函数 $y=f(x)$ 且有：

```math
\frac{dy}{dx} = -\frac{F_x'}{F_y'}
```

## 相关几何应用



### 平面曲线

平面曲线 $x=φ(t),y=\psi(t)$ 点 $M_0(x_0,y_0)$ 为曲线上对应参数点 $t=t_0$ 的一点，则曲线在点 $M_0$ 处:

- 切向量：  $T = (φ'(t_0),\psi'(t_0))$ 
- 切线方程： $\frac{x-x_0}{φ'(t_0)} = \frac{y-y_0}{\psi'(t_0)}$
- 法线方程：$φ'(t_0)(x-x_0) + \psi'(t_0)(y-y_0)=0$



平面曲线 $F(x,y)=0$，那么在曲线上一点 $M_0(x_0,y_0)$ 处：

- 法向量：$n=(F_x(x_0,y_0),F_y(x_0,y_0))$
- 切线方程：$F_x(x_0,y_0)(x-x_0)+F_y(x_0,y_0)(y-y_0)=0$
- 法线方程：$\frac{x-x_0}{F_x(x_0,y_0)}=\frac{y-y_0}{F_y(x_0,y_0)}$



### 空间曲线

空间曲线 $x=φ(t),y=\psi(t)，z=\omega(t)$ 点 $M_0(x_0,y_0,z_0)$ 为曲线上对应参数点 $t=t_0$ 的一点，则曲线在点 $M_0$ 处:

- 切向量：  $T = (φ'(t_0),\psi'(t_0),\omega'(t_0))$ 
- 切线方程： $\frac{x-x_0}{φ'(t_0)} = \frac{y-y_0}{\psi'(t_0)} = \frac{z-z_0}{\omega'(t_0)}$
- 法线方程：$φ'(t_0)(x-x_0) + \psi'(t_0)(y-y_0) + \omega'(t_0)(z-z_0)=0$



若曲线方程为隐函数，如 $F(x,y,z)=0,G(x,y,z)=0$ 不妨将其转换成参数方程，如 $x=x,y=y(x),z=z(x)$ 以简化计算



### 曲面

设曲线方程 $F(x,y,z)=0$ 点 $P_0(x_0,y_0,z_0)$ 为曲面上一点，若函数 $F(x,y,z)$ 在点 $(x_0,y_0,z_0)$ 处有连续偏导且不为零，则在点 $P_0$ 处：

- 法向量： $n=(F_x(P_0),F_y(P_0),F_z(P_0))$
- 切平面：$F_x(P_0)(x-x_0)+F_y(P_0)(y-y_0)+F_z(P_0)(z-z_0)=0$
- 法线：$\frac{x-x_0}{F_x(P_0)}=\frac{y-y_0}{F_y(P_0)}=\frac{z-z_0}{F_z(P_0)}$

 

## 方向导数与梯度



### 方向导数

**定义**：

- 设 $l$ 是从点 $P_0(x_0,y_0)$ 发出的一条射线，方向角为 $\alpha,\beta$ 。

- 从点 $P_0$ 出发沿着 $l$ 经过距离 $t$ 到达点 $P(x_0+tcos\alpha,y_0+tcos\beta)$ ，

则函数 $f(x,y)$ 在点 $P_0$  沿着 $l$ 方向的方向导数为：

```math
\frac{\partial f}{\partial l}|_{(x_0,y_0)} = lim_{t\rightarrow 0^+} \frac{f(x_0+tcos\alpha,y_0+tcos\beta)-f(x_0,y_0)}{t}
```

通过全微分可以得到： $df=f_x(x,y)dx+f_y(x,y)dy$

对于 $dx,dy$ 有：$dx=dl·cos\alpha, dy=dl·cos\beta$

**于是可以得到**：$\frac{\partial f}{\partial l} = f_x(x,y)cos\alpha+f_y(x,y)cos\beta$ 



### 梯度

设函数 $f(x,y)$ 在平面区域 $D$ 内具有连续的偏导数，点 $P_0(x_0,y_0)$ 在 $D$ 内

则向量 $f_x(x_0,y_0)i + f_y(x_0,y_0)j$ 为函数 $f(x,y)$ 在点 $P_0$ 处的梯度。

记作 $gradf(x_0,y_0)$ 或 $\nabla f(x_0,y_0)$



设函数 $f(x,y)$ 在点 $P_0(x_0,y_0)$ 处可微分，方向 $l$ 的方向角是 $\alpha,\beta$ 则 $e_l=(cos\alpha,cos\beta)$ 是与 $l$ 同向的单位向量，那么就能得到：

```math
\frac{\partial f}{\partial l} = f_x(x,y)cos\alpha+ f_y(x,y)cos\beta \\
\Rightarrow \frac{\partial f}{\partial l} = \nabla f(x,y) · e_l
```

​	

## 多元函数的极值



### 无条件极值

**定义：**

设函数 $z=f(x,y)$ 的定义域为 $D，P_0(x_0,y_0)$ 为 $D$ 的内点。

若有点 $P_0(x_0,y_0)$ 的某个邻域 $U(P_0)$ ，在该邻域内，对 $P_0$ 之外的任意点 $P(x,y)$ 都有：

```math
f(x,y)<f(x_0,y_0)
```

则称 $f(x_0,y_0)$ 为函数 $f(x,y)$ 的极大值，点 $P_0$ 称为极大值点。极小值同理。

极大值和极小值统称极值，极大值点和极小值点统称极值点。



**极值的必要条件：**

若函数 $z=f(x,y)$ 在点 $(x_0,y_0)$ 处具有有偏导数，且在该点处有极值，那么有：

```math
f_x'(x_0,y_0) = f_y'(x_0,y_0) = 0
```



**极值的充分条件：**

若函数 $z=f(x,y)$ 在点 $(x_0,y_0)$ 的某一邻域内有连续的一阶偏导和二阶偏导，且一阶偏导为零，那么将几个二阶偏导记为：

```math
f_{xx}''(x_0,y_0)=A,\ f_{xy}''(x_0,y_0)=B,\ f_{yy}''(x_0,y_0)=C
```

可以得到判别式：$AC-B^2$ (通过Hessian矩阵算得)

- $AC-B^2>0$，$f(x_0,y_0)$ 是极值，若 $A<0$ 为极大值，若 $A>0$ 为极小值。
- $AC-B^2<0$，$f(x_0,y_0)$ 不是极值。
- $AC-B^2=0$，$f(x_0,y_0)$ 无法确定是否为极值，需要另外讨论。



### 条件极值和拉格朗日数乘法

若函数 $f(x,y)$ 及 $φ(x,y)$ 均有连续的偏导数。$(x_0,y_0)$ 为条件极值点,且 $φ′_y(x_0,y_0)\neq 0$ ($φ′_x(x_0,y_0)\neq 0$ 可类似讨论)。考虑函数 $f(x,y)$ 在条件 $φ(x,y)=0$ 下的极值。在点 $(x_0,y_0)$ 的一个邻域内可以确定函数 $y=y(x)$ ,那么 $x=x_0$ 是函数 $f(x,y(x))$ 的极值点。（$x=x(y), y=y_0$ 作为极值点同理）



那么（由费马引理）会有：

```math
\frac{df(x,y(x))}{dx}|_{x=x_0}=f′_x(x_0,y_0)+f′_y(x_0,y_0)·\frac{dy}{dx}|_{x=x_0}=0.
\\ \frac{dy}{dx}|_{x=x_0} = -\frac{φ'_x(x_0,y_0)}{φ'_y(x_0,y_0)}
```

于是有：

```math
\frac{f'_x(x_0,y_0)}{φ'_x(x_0,y_0)}=\frac{f'_y(x_0,y_0)}{φ'_y(x_0,y_0)}
```

将比值设为$-\lambda$ ，于是就能得到：

```math
f′_x(x_0,y_0)+\lambdaφ′_x(x_0,y_0)=0 \\f′_y(x_0,y_0)+\lambdaφ′_y(x_0,y_0)=0
```

那么令	$L(x,y)=f(x,y)+λφ(x,y)$

就能得到：

```math
L′_x(x_0,y_0)=0 
\\ L′_y(x_0,y_0)=0
```

与 $φ(x_0,y_0)=0$ 联立即可求得点 $(x_0,y_0)$

上述方法即为**拉格朗日数乘法**。$L(x,y)$ 为拉格朗日函数，$\lambda$ 为拉格朗日乘数。

在遇到存在多个限制条件时，可引入多个拉格朗日乘数参与计算。
